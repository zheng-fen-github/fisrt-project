{"version":3,"file":"static/webpack/static\\development\\pages\\home.js.95ee4bd01eac4a29b79d.hot-update.js","sources":["webpack:///./component/home/main/postlist/list/features.js"],"sourcesContent":["import React,{useEffect} from 'react'\r\nimport CommentList from './features-comment'\r\nimport Router  from 'next/router'\r\n\r\nfunction Features({id,comment,message}) {\r\n    let formRef = React.createRef();\r\n    let buAllRef;\r\n\r\n    useEffect(() => {                      //判断帖子中是否收藏 点赞过       \r\n       if(message){           \r\n            let result = message.like.findIndex(e => e.postId == id);\r\n            if(result != -1 ){\r\n            buAllRef.children[0].children[0].classList.add('icon-dianzan1');\r\n            }\r\n            let result2 = message.save.findIndex(e => e.postId == id);\r\n            if(result2 != -1 ){\r\n            buAllRef.children[1].children[0].classList.add('icon-shoucang1');\r\n            }\r\n       }       \r\n    },[])\r\n    const commentEv = () => {        //打开评论界面按钮事件\r\n           let form = formRef.current;\r\n           if(getComputedStyle(form).display == 'none'){\r\n                form.style.display = 'flex';           \r\n                if(!form.hidden) form.children[0].focus();\r\n           }else{\r\n                form.style.display = 'none';           \r\n           }\r\n           \r\n    }\r\n    const saveEv = async (e) => {\r\n        let target = e.target.closest('.save').children[0]; //定义save按钮元素\r\n        target.classList.toggle('icon-shoucang1');\r\n        if(target.classList.contains('icon-shoucang1')){     \r\n            let request = await fetch(`http://localhost:3001/post/save/${id}`,{\r\n                method:'POST',\r\n                credentials: \"include\",\r\n            })\r\n            if(request.status == 404) Router.push('/')\r\n            if(request.status == 303) target.classList.remove('icon-shoucang1');\r\n            let res =await  request.json();\r\n            alert(res);\r\n        }else{\r\n            \r\n            let request = await fetch(`http://localhost:3001/post/save/remove/${id}`,{\r\n                method:'POST',\r\n                credentials: \"include\",\r\n            })\r\n            if(request.status == 404) Router.push('/')\r\n            let res =await  request.json();\r\n            alert(res);\r\n        }\r\n    }\r\n    const likeEv = async (e) => {\r\n        let target = e.target.closest('.like').children[0]; //定义like按钮元素\r\n        target.classList.toggle('icon-dianzan1');\r\n        if(target.classList.contains('icon-dianzan1')){     \r\n            let request = await fetch(`http://localhost:3001/post/like/${id}`,{\r\n                method:'POST',\r\n                credentials: \"include\",\r\n            })\r\n            if(request.status == 404) Router.push('/')\r\n            if(request.status == 303) target.classList.remove('icon-dianzan1');\r\n            let res =await  request.json();\r\n            alert(res);\r\n        }else{\r\n            \r\n            let request = await fetch(`http://localhost:3001/post/like/remove/${id}`,{\r\n                method:'POST',\r\n                credentials: \"include\",\r\n            })\r\n            if(request.status == 404) Router.push('/')\r\n            let res =await  request.json();\r\n            alert(res);\r\n        }\r\n\r\n        \r\n       \r\n    }\r\n    return (\r\n       <div className=\"features\">\r\n           <CommentList ref ={formRef} id ={id} comment={comment}/>\r\n           <div className=\"button-All\" ref={ref => buAllRef = ref}>\r\n                <div className=\"like\" onClick={likeEv}>                  \r\n                    <i className='iconfont icon-dianzan'></i>\r\n                    <h4>Like</h4>\r\n                </div>\r\n                <div className=\"save\" onClick={saveEv}>\r\n                    <i className='iconfont icon-shoucang'></i>\r\n                    <h4>save</h4>\r\n                </div>\r\n                <div className=\"comment\" onClick={commentEv}>\r\n                    <i className='iconfont icon-pinglun'></i>\r\n                    <h4>comment</h4>\r\n                </div>\r\n                <div className=\"share\">\r\n                    <i className='iconfont icon-fenxiang'></i>\r\n                    <h4>share</h4>\r\n                </div>\r\n            </div>\r\n            <style jsx> {`                \r\n                  i {\r\n                      font-size:30px;\r\n                      margin-right:6px;\r\n                  }\r\n                  .icon-dianzan1 {\r\n                      color:#E84F43;\r\n                      animation:click 0.5s 1;\r\n                  }\r\n                  .icon-shoucang1{\r\n                      color:#FFF710;\r\n                      animation:click 0.5s 1;\r\n                  }\r\n\r\n\r\n                  @keyframes click {\r\n                      0% {\r\n                          transform:scale(0)\r\n                      }\r\n                      100% {\r\n                          transform:scale(1)\r\n                      }\r\n                  }\r\n                  .button-All {\r\n                      width:100%;\r\n                      display:flex;\r\n                      height:8vh;\r\n                      align-items:center;\r\n                      justify-content:space-between;\r\n                  }\r\n                  .button-All>div {\r\n                       display:flex;\r\n                       flex:1;\r\n                       height:6vh;\r\n                       justify-content:center;\r\n                       align-items:center;\r\n                       margin-right:4vh;\r\n                       opacity:0.5;\r\n                  }\r\n                  .button-All>div:hover {\r\n                      opacity:1;\r\n                  }\r\n                  .like {\r\n                      margin-left:4vh;\r\n                  }\r\n                  .share svg {\r\n                        margin-right:0.4vh;\r\n                  }\r\n                  svg {\r\n                      height:50%;\r\n                  }\r\n                        `}\r\n       </style>\r\n        </div> \r\n    )\r\n}\r\n\r\n\r\nexport default Features\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAKA;AACA;AAFA;AACA;AALA;AAIA;AAIA;AACA;AATA;AAAA;AACA;AADA;AAUA;AACA;AAXA;AAAA;AACA;AADA;AAAA;AAAA;AAeA;AACA;AAFA;AACA;AAfA;AAcA;AAIA;AAlBA;AAAA;AACA;AADA;AAmBA;AACA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAsBA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAKA;AACA;AAFA;AACA;AALA;AAIA;AAIA;AACA;AATA;AAAA;AACA;AADA;AAUA;AACA;AAXA;AAAA;AACA;AADA;AAAA;AAAA;AAeA;AACA;AAFA;AACA;AAfA;AAcA;AAIA;AAlBA;AAAA;AACA;AADA;AAmBA;AACA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAyBA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAjBA;AAAA;AAAA;AA2EA;AACA;AAEA;;;;A","sourceRoot":""}