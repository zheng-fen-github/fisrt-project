{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { ADD } from '../../redux/action';\nvar FeaturesComment = React.forwardRef(function (props, ref) {\n  var _useState = useState(''),\n      message = _useState[0],\n      setMessage = _useState[1];\n\n  var _useState2 = useState(props.comment),\n      commentList = _useState2[0],\n      setCommentList = _useState2[1];\n\n  var addComment = function addComment(e) {\n    var commentData, request, res;\n    return _regeneratorRuntime.async(function addComment$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // 添加评论事件\n            e.preventDefault();\n            commentData = new FormData();\n            commentData.append('comment', message);\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(fetch(\"http://localhost:3001/post/comment/\".concat(props.id), {\n              method: 'POST',\n              body: commentData,\n              credentials: \"include\"\n            }));\n\n          case 5:\n            request = _context.sent;\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(request.json());\n\n          case 8:\n            res = _context.sent;\n\n            if (typeof res == 'object') {\n              setCommentList(res);\n            }\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var inputEv = function inputEv(e) {\n    if (e.target.value.length > 0) {\n      ref.current.children[1].classList.add('pink');\n    } else {\n      ref.current.children[1].classList.remove('pink');\n    }\n\n    setMessage(e.target.value);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-2061813821\" + \" \" + \"comment-list\"\n  }, __jsx(\"ul\", {\n    className: \"jsx-2061813821\"\n  }, commentList.map(function (e) {\n    return __jsx(\"li\", {\n      key: e,\n      className: \"jsx-2061813821\"\n    }, e.comment, \"\\uD83D\\uDC97\");\n  })), __jsx(\"form\", {\n    ref: ref,\n    onSubmit: addComment,\n    hidden: true,\n    className: \"jsx-2061813821\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"comment\",\n    onInput: inputEv,\n    value: message,\n    required: true,\n    placeholder: \"\\u8F93\\u5165\\u5185\\u5BB9\",\n    className: \"jsx-2061813821\"\n  }), __jsx(\"div\", {\n    onClick: function onClick(e) {\n      e.target.closest('.button').nextElementSibling.click();\n    },\n    className: \"jsx-2061813821\" + \" \" + \"button\"\n  }, __jsx(\"i\", {\n    className: \"jsx-2061813821\" + \" \" + 'iconfont icon-send'\n  })), __jsx(\"input\", {\n    type: \"submit\",\n    value: \"add\",\n    hidden: true,\n    className: \"jsx-2061813821\"\n  })), __jsx(_JSXStyle, {\n    id: \"2061813821\"\n  }, [\".button.jsx-2061813821{-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:50%;}\", \".button.jsx-2061813821:hover>i.jsx-2061813821{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1);background:#1a79ff;color:white;}\", \".button.jsx-2061813821>i.jsx-2061813821{font-size:1.6rem;padding:10px;border-radius:50%;}\", \"form.jsx-2061813821{width:100%;height:6vh;background:white;border-radius:24px;margin:4vh 0 0;display:none;}\", \"input[type=submit].jsx-2061813821{color:white;}\", \"form.jsx-2061813821>input.jsx-2061813821{-webkit-flex:9;-ms-flex:9;flex:9;text-align:center;height:100%;border:2px solid #f4f6f8;font-size:3vh;padding:0 2vh;outline:none;}\", \"input[type=text].jsx-2061813821{color:white;}\", \"form.jsx-2061813821>input.jsx-2061813821:focus{background:#eeeef4;}\", \".comment-list.jsx-2061813821{width:100%;margin:4vh 0 2vh;}\", \"ul.jsx-2061813821{width:80%;margin-left:10%;list-style:none;}\", \"li.jsx-2061813821{width:100%;height:2vh;margin:1vh;text-align:center;}\"]));\n});\n\nvar dispatchToProps = function dispatchToProps(dispatch) {\n  return {\n    Click: function Click(post) {\n      dispatch(ADD(post));\n    }\n  };\n};\n\nvar stateToProps = function stateToProps(state) {\n  return {};\n};\n\nexport default connect(null, dispatchToProps, null, {\n  forwardRef: true\n})(FeaturesComment);","map":null,"metadata":{},"sourceType":"module"}